<view class="container"><conv-card wx:if="{{a}}" bindupdateShow="{{b}}" u-i="789d2176-0" bind:__l="__l" bindupdateEmoji="{{c}}" bindupdateContent="{{d}}" u-p="{{e}}"/><reward-card wx:if="{{f}}" bindsaveNote="{{g}}" bindupdateShow="{{h}}" u-i="789d2176-1" bind:__l="__l" u-p="{{i}}"/><view class="header"><view class="date-info"><view class="flip-clock"><text wx:if="{{j}}" class="streak-icon">{{k}}</text><text class="streak-label">连胜</text><text class="time-unit">{{l}}</text><text class="streak-label">天</text></view></view><view class="header-row"><view class="habit-stats"><view class="progress-bar"><view style="{{'width:' + m}}" class="{{['progress-fill', n && 'perfect']}}"></view></view></view><view wx:if="{{o}}" class="complete-order-btn" bindtap="{{p}}">完成排序</view></view><view class="ai-message"><view class="ai-message-card" bindtap="{{s}}"><text class="ai-message-icon">{{q}}</text><text class="ai-message-content">{{r}}</text></view></view></view><view class="view-container"><view class="view-page habits-list" style="{{'transform:' + y}}"><view wx:for="{{t}}" wx:for-item="habit" wx:key="p" class="{{['habit-card', habit.q && 'is-flipped', w && 'is-order-mode', x && 'no-interaction', habit.s && habit.r]}}" bindlongpress="{{habit.t}}" bindtouchend="{{habit.v}}"><view class="card-face card-front"><view class="habit-header"><view class="title-section"><view class="habit-icon" style="{{'background-color:' + habit.b}}"><text class="emoji-icon">{{habit.a}}</text></view><text class="habit-title">{{habit.c}}</text></view><view class="more-actions" catchtap="{{habit.d}}"><text class="more-icon">⋮</text></view></view><view wx:if="{{v}}" class="order-buttons"><view class="{{['order-btn', 'up', habit.e && 'disabled']}}" catchtap="{{habit.f}}"><text class="order-icon">↑</text></view><view class="{{['order-btn', 'down', habit.g && 'disabled']}}" catchtap="{{habit.h}}"><text class="order-icon">↓</text></view></view><view class="habit-content"><view class="progress-view"><view wx:for="{{habit.i}}" wx:for-item="day" wx:key="g" class="week-day"><text class="day-label">{{day.a}}</text><view class="{{['day-box', day.c && 'completed', day.d && 'today', day.e && 'future']}}" catchtap="{{day.f}}">{{day.b}}</view></view></view></view><view class="notes-container" hidden="{{!habit.l}}"><view wx:if="{{habit.j}}" class="empty-notes"><text>本周还没有记录历程哦~</text></view><view wx:else class="notes-list"><view wx:for="{{habit.k}}" wx:for-item="note" wx:key="e" class="note-item"><view class="note-time"><view class="time-left"><text class="date">{{note.a}}</text><text class="time">{{note.b}}</text></view><view class="time-right">{{note.c}}</view></view><view class="note-content">{{note.d}}</view></view></view></view></view><view class="card-face card-back"><view wx:if="{{habit.m}}" class="flag-banner"><text class="flag-icon">🎯</text><text class="flag-text">{{habit.n}}</text></view><view wx:else class="flag-banner"><text class="flag-icon">✨</text><text class="flag-text">点击习惯卡片右上角的按钮\n选择编辑添加目标！</text></view><view class="create-time"><text class="time-label">创建于</text><text class="time-value">{{habit.o}}</text></view></view></view></view></view></view><view wx:if="{{z}}" class="add-button" bindtap="{{A}}"><text class="plus">+</text></view>