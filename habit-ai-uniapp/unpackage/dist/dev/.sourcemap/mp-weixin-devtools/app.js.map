{"version":3,"names":["_sfc_main","onLaunch","common_vendor","index","__f__","checkAndRestoreData","utils_storage","checkAutoBackup","onShow","onHide","methods","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","habits","backupInfo","wrap","_callee$","_context","prev","next","getStorageSync","length","checkBackupAvailable","available","showModal","title","content","success","res","confirm","result","restoreFromBackup","showToast","icon","stop"],"sources":["App.vue"],"sourcesContent":["<script>\r\nimport * as utils_storage from \"./utils/storage.js\";\r\n\r\nexport default {\r\n  // App 启动时调用\r\n  onLaunch() {\r\n    common_vendor.index.__f__(\"log\", \"at App.vue:6\", \"App Launch\");\r\n    this.checkAndRestoreData();\r\n    utils_storage.checkAutoBackup();\r\n  },\r\n  // App 显示时调用\r\n  onShow() {\r\n    common_vendor.index.__f__(\"log\", \"at App.vue:12\", \"App Show\");\r\n  },\r\n  // App 隐藏时调用\r\n  onHide() {\r\n    common_vendor.index.__f__(\"log\", \"at App.vue:15\", \"App Hide\");\r\n    utils_storage.checkAutoBackup();\r\n  },\r\n  methods: {\r\n    // 检查本地数据，如果数据为空则检测备份并提示恢复\r\n    async checkAndRestoreData() {\r\n      const habits = common_vendor.index.getStorageSync(\"habits\");\r\n      if (!habits || habits.length === 0) {\r\n        const backupInfo = utils_storage.checkBackupAvailable();\r\n        if (backupInfo.available) {\r\n          common_vendor.index.showModal({\r\n            title: \"发现数据备份\",\r\n            content: \"检测到您有可用的数据备份，是否恢复？\",\r\n            success: (res) => {\r\n              if (res.confirm) {\r\n                const result = utils_storage.restoreFromBackup();\r\n                if (result.success) {\r\n                  common_vendor.index.showToast({\r\n                    title: \"数据恢复成功\",\r\n                    icon: \"success\"\r\n                  });\r\n                } else {\r\n                  common_vendor.index.showToast({\r\n                    title: \"数据恢复失败\",\r\n                    icon: \"none\"\r\n                  });\r\n                }\r\n              }\r\n            }\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.container, page {\r\n    background-color: #fff;\r\n}\r\n\r\n.container {\r\n    min-height: 100vh;\r\n}\r\n\r\npage {\r\n    --status-bar-height: 25px;\r\n    --top-window-height: 0px;\r\n    --window-top: 0px;\r\n    --window-bottom: 0px;\r\n    --window-left: 0px;\r\n    --window-right: 0px;\r\n    --window-magin: 0px;\r\n}\r\n\r\n[data-c-h=\"true\"] {\r\n    display: none!important;\r\n}\r\n</style>"],"mappings":";;;;;;;;;;;;;;;;AAGA,IAAKA,SAAA,GAAU;EAAA;EAEbC,QAAA,WAAAA,SAAA,EAAW;IACTC,aAAA,CAAcC,KAAA,CAAMC,KAAA,CAAM,OAAO,gBAAgB,YAAY;IAC7D,KAAKC,mBAAA,EAAmB;IACxBC,aAAA,CAAAC,eAAA;EACD;EAAA;EAEDC,MAAA,WAAAA,OAAA,EAAS;IACPN,aAAA,CAAcC,KAAA,CAAMC,KAAA,CAAM,OAAO,iBAAiB,UAAU;EAC7D;EAAA;EAEDK,MAAA,WAAAA,OAAA,EAAS;IACPP,aAAA,CAAcC,KAAA,CAAMC,KAAA,CAAM,OAAO,iBAAiB,UAAU;IAC5DE,aAAA,CAAAC,eAAA;EACD;EACDG,OAAA,EAAS;IAAA;IAEDL,mBAAA,WAAAA,oBAAA,EAAsB;MAAA,OAAAM,kBAAA,eAAAC,oBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,MAAA,EAAAC,UAAA;QAAA,OAAAJ,oBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cACpBN,MAAA,GAASb,aAAA,CAAcC,KAAA,CAAMmB,cAAA,CAAe,QAAQ;cAC1D,IAAI,CAACP,MAAA,IAAUA,MAAA,CAAOQ,MAAA,KAAW,GAAG;gBAC5BP,UAAA,GAAaV,aAAA,CAAAkB,oBAAA;gBACnB,IAAIR,UAAA,CAAWS,SAAA,EAAW;kBACxBvB,aAAA,CAAcC,KAAA,CAAMuB,SAAA,CAAU;oBAC5BC,KAAA,EAAO;oBACPC,OAAA,EAAS;oBACTC,OAAA,EAAS,SAATA,QAAUC,GAAA,EAAQ;sBAChB,IAAIA,GAAA,CAAIC,OAAA,EAAS;wBACf,IAAMC,MAAA,GAAS1B,aAAA,CAAA2B,iBAAA;wBACf,IAAID,MAAA,CAAOH,OAAA,EAAS;0BAClB3B,aAAA,CAAcC,KAAA,CAAM+B,SAAA,CAAU;4BAC5BP,KAAA,EAAO;4BACPQ,IAAA,EAAM;0BACR,CAAC;wBAAA,OACI;0BACLjC,aAAA,CAAcC,KAAA,CAAM+B,SAAA,CAAU;4BAC5BP,KAAA,EAAO;4BACPQ,IAAA,EAAM;0BACR,CAAC;wBACH;sBACF;oBACF;kBACF,CAAC;gBACH;cACF;YAAA;YAAA;cAAA,OAAAhB,QAAA,CAAAiB,IAAA;UAAA;QAAA,GAAAtB,OAAA;MAAA;IACF;EACF;AACF","ignoreList":[]}