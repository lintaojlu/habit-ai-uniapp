{"version":3,"names":["_sfc_main","name","props","show","type","Boolean","default","value","String","data","characters","currentIndex","isClosingDown","isDragging","startY","currentY","computed","currentCharacter","dragStyle","translateY","Math","max","transform","concat","transition","created","loadCharacters","methods","_this","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","response","index","wrap","_callee$","_context","prev","next","utils_api","apiService","getAICharacterList","sent","status","findIndex","c","character_id","t0","common_vendor","__f__","showToast","title","icon","stop","onSwiperChange","e","detail","current","character","$emit","handleTouchStart","touches","clientY","handleTouchMove","preventDefault","handleTouchEnd","dragDistance","closeCard","_this2","setTimeout","handleContainerClick","wx","createComponent","Component"],"sources":["AICharacterList.vue","AICharacterList.vue?type=component"],"sourcesContent":["<template>\n  <view class=\"character-list\">\n    <view \n      v-for=\"character in characters\" \n      :key=\"character.character_id\" \n      class=\"character-item\"\n      @tap=\"onSelectCharacter(character)\"\n      :class=\"{ 'selected': selectedId === character.character_id }\"\n    >\n      <text class=\"character-icon\">{{ character.icon }}</text>\n      <view class=\"character-info\">\n        <text class=\"character-name\">{{ character.name }}</text>\n        <text class=\"character-desc\">{{ character.description }}</text>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { apiService } from '@/utils/api.js'\n\nexport default {\n  name: 'AICharacterList',\n  \n  props: {\n    show: {\n      type: Boolean,\n      default: false\n    },\n    value: {\n      type: String,\n      default: ''\n    }\n  },\n\n  data() {\n    return {\n      characters: [],\n      currentIndex: 0,\n      isClosingDown: false,\n      isDragging: false,\n      startY: 0,\n      currentY: 0\n    }\n  },\n\n  computed: {\n    currentCharacter() {\n      return this.characters[this.currentIndex] || {}\n    },\n    \n    dragStyle() {\n      if (!this.isDragging) return {}\n      const translateY = Math.max(0, this.currentY - this.startY)\n      return {\n        transform: `translateY(${translateY}px)`,\n        transition: 'none'\n      }\n    }\n  },\n\n  created() {\n    this.loadCharacters()\n  },\n\n  methods: {\n    async loadCharacters() {\n      try {\n        const response = await apiService.getAICharacterList()\n        if (response.status === 'success') {\n          this.characters = response.data\n          if (this.value) {\n            const index = this.characters.findIndex(c => c.character_id === this.value)\n            if (index !== -1) {\n              this.currentIndex = index\n            }\n          }\n        }\n      } catch (error) {\n        console.error('加载 AI 角色失败:', error)\n        uni.showToast({\n          title: '加载失败',\n          icon: 'none'\n        })\n      }\n    },\n\n    onSwiperChange(e) {\n      this.currentIndex = e.detail.current\n      const character = this.characters[this.currentIndex]\n      this.$emit('input', character.character_id)\n      this.$emit('change', character)\n    },\n\n    handleTouchStart(e) {\n      this.startY = e.touches[0].clientY\n      this.isDragging = true\n    },\n\n    handleTouchMove(e) {\n      if (!this.isDragging) return\n      this.currentY = e.touches[0].clientY\n      e.preventDefault()\n    },\n\n    handleTouchEnd(e) {\n      if (!this.isDragging) return\n      const dragDistance = this.currentY - this.startY\n      if (dragDistance > 100) {\n        this.closeCard()\n      }\n      this.isDragging = false\n      this.startY = 0\n      this.currentY = 0\n    },\n\n    closeCard() {\n      this.isClosingDown = true\n      setTimeout(() => {\n        this.$emit('update:show', false)\n        this.isClosingDown = false\n      }, 500)\n    },\n\n    handleContainerClick() {\n      this.closeCard()\n    }\n  }\n}\n</script>\n\n<style>\n.character-list {\n  padding: 20rpx;\n}\n\n.character-item {\n  display: flex;\n  align-items: center;\n  padding: 30rpx;\n  margin-bottom: 20rpx;\n  background: #ffffff;\n  border-radius: 12rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n}\n\n.character-item.selected {\n  background: var(--theme-color);\n}\n\n.character-item.selected .character-name,\n.character-item.selected .character-desc {\n  color: #ffffff;\n}\n\n.character-icon {\n  font-size: 48rpx;\n  margin-right: 20rpx;\n}\n\n.character-info {\n  flex: 1;\n}\n\n.character-name {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 8rpx;\n}\n\n.character-desc {\n  font-size: 26rpx;\n  color: #666;\n}\n</style>","import Component from '/Users/linsir/Experiments/uni-app/habit-ai-uniapp/habit-ai-uniapp/components/AICharacterList.vue'\nwx.createComponent(Component)"],"mappings":"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","ignoreList":[]}