{"version":3,"names":["baseURL","request","options","Promise","resolve","reject","token","common_vendor","index","getStorageSync","url","method","data","header","_objectSpread2","concat","success","res","__f__","statusCode","redirectTo","Error","message","fail","err","apiService","register","userData","login","loginData","getUserInfo","updateUserInfo","createHabit","habitData","getHabitInfo","habitId","updateHabit","habit_id","deleteHabit","recordHabit","getHabitStreak","getHabitList","getAICharacterList","getLastMessage","getNewMessage","feedback","params"],"sources":["api.js"],"sourcesContent":["// utils/api.js\nconst baseURL = 'http://123.56.229.52:9000';\n// const baseURL = 'https://www.tempoai.top'\n\n// Export the request function\nexport function request(options) {\n    return new Promise((resolve, reject) => {\n        // 获取 token\n        const token = uni.getStorageSync('token');\n        \n        uni.request({\n            url: baseURL + options.url,\n            method: options.method || 'GET',\n            data: options.data || {},\n            header: {\n                'Content-Type': 'application/json',\n                'Authorization': token ? `Bearer ${token}` : '',\n                ...options.header\n            },\n            success: (res) => {\n                console.log(`[API Request] ${options.url} - ${options.method}`, options.data);\n\n                if (res.statusCode === 401) {\n                    console.log(`[API Response] ${options.url} - 401 Unauthorized`);\n                    uni.redirectTo({ url: '/pages/login/login' });\n                    reject(new Error('登录失败，请重新登录'));\n                    return;\n                }\n                \n                if (res.statusCode >= 200 && res.statusCode < 300) {\n                    resolve(res.data);\n                } else {\n                    console.error(`[API Response] ${options.url} - Failed:`, res);\n                    reject(res.data || { message: '请求失败' });\n                }\n            },\n            fail: (err) => {\n                console.log(`[API Request] ${options.url} - ${options.method}`, options.data);\n                console.error(`[API Response] ${options.url} - Error:`, err);\n                reject(err || { message: '网络错误' });\n            }\n        });\n    });\n}\n// Mock API 服务，确保所有请求都返回成功\nexport const apiService = {\n    register(userData) {\n        return request({\n            url: '/habit-ai/user/register',\n            method: 'POST',\n            data: userData\n        });\n    },\n    \n    login(loginData) {\n        return request({\n            url: '/habit-ai/user/login',\n            method: 'POST',\n            data: loginData\n        });\n    },\n    \n    getUserInfo() {\n        return request({\n            url: '/habit-ai/user/info',\n            method: 'GET'\n        });\n    },\n    \n    updateUserInfo(userData) {\n        return request({\n            url: '/habit-ai/user/update',\n            method: 'PUT',\n            data: userData\n        });\n    },\n    \n    createHabit(habitData) {\n        return request({\n            url: '/habit-ai/habit/create',\n            method: 'POST',\n            data: habitData\n        });\n    },\n    \n    getHabitInfo(habitId) {\n        return request({\n            url: `/habit-ai/habit/info?habit_id=${habitId}`,\n            method: 'GET'\n        });\n    },\n    \n    updateHabit(habit_id, habitData) {\n        return request({\n            url: '/habit-ai/habit/update',\n            method: 'PUT',\n            data: { habit_id, ...habitData }\n        });\n    },\n    \n    deleteHabit(habitId) {\n        return request({\n            url: '/habit-ai/habit/delete',\n            method: 'DELETE',\n            data: { habit_id: habitId }\n        });\n    },\n    \n    recordHabit(habitId) {\n        return request({\n            url: '/habit-ai/habit/checkin',\n            method: 'POST',\n            data: { habit_id: habitId }\n        });\n    },\n    \n    getHabitStreak(habitId) {\n        return request({\n            url: `/habit-ai/habit/streak?habit_id=${habitId}`,\n            method: 'GET'\n        });\n    },\n    \n    getHabitList() {\n        return request({\n            url: '/habit-ai/habit/list',\n            method: 'GET'\n        });\n    },\n\n    getAICharacterList() {\n        return request({\n            url: '/habit-ai/character/list',\n            method: 'GET'\n        });\n    },\n\n    getLastMessage() {\n        return request({\n            url: `/habit-ai/message/last`,\n            method: 'GET'\n        });\n    },\n    \n    getNewMessage() {\n        return request({\n            url: '/habit-ai/message/new',\n            method: 'GET',\n        });\n    },\n\n    feedback(params) {\n        return request({\n            url: '/habit-ai/feedback',\n            method: 'POST',\n            data: params\n        });\n    }\n};\n\n// 移除示例接口\nexport const getData = (params) => {\n    return request({ url: '/data', method: 'GET', data: params });\n};\n\nexport const postData = (data) => {\n    return request({ url: '/data', method: 'POST', data });\n};"],"mappings":"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","ignoreList":[]}