{"version":3,"file":"settings.js","sources":["pages/settings/settings.vue","pages/settings/settings.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <!-- Áî®Êà∑‰ø°ÊÅØÂå∫Âüü -->\n    <view class=\"settings-card user-info-section\">\n      <view class=\"avatar-wrapper\">\n        <image class=\"avatar\" :src=\"userInfo.avatar_url || 'https://mmbiz.qpic.cn/mmbiz/icTdbqWNOwNRna42FI242Lcia07jQodd2FJGIYQfG0LAJGFxM4FbnQP6yfMxBgJ0F3YRqJCJ1aPAK2dQagdusBZg/0'\" mode=\"aspectFill\"/>\n      </view>\n      <view class=\"user-info\">\n        <text class=\"nickname\">{{ userInfo.nickname || 'Êú™ËÆæÁΩÆÊòµÁß∞' }}</text>\n      </view>\n    </view>\n\n    <!-- AIËÆæÁΩÆÂå∫Âüü -->\n    <view class=\"settings-card setting-item\">\n      <view class=\"setting-left\">\n        <text class=\"setting-icon\">ü§ñ</text>\n        <text class=\"setting-label\">ËßíËâ≤ËÆæÁΩÆ</text>\n      </view>\n      <picker \n        ref=\"rolePicker\"\n        class=\"role-picker\" \n        :value=\"selectedRoleIndex\" \n        :range=\"aiCharacterNames\" \n        @change=\"onRoleChange\"\n      >\n        <view class=\"picker-value\">\n          {{ currentCharacterName }}\n          <text class=\"arrow\">></text>\n        </view>\n      </picker>\n    </view>\n\n    <!-- ÈöêÁßÅËÆæÁΩÆ -->\n    <view class=\"settings-card setting-item\" @tap=\"onPrivacy\">\n      <view class=\"setting-left\">\n        <text class=\"setting-icon\">üîí</text>\n        <text class=\"setting-label\">ÈöêÁßÅËÆæÁΩÆ</text>\n      </view>\n      <text class=\"arrow\">></text>\n    </view>\n\n    <!-- Áî®Êà∑ÂèçÈ¶àÂå∫Âüü -->\n    <view class=\"settings-card setting-item\" @tap=\"onFeedback\">\n      <view class=\"setting-left\">\n        <text class=\"setting-icon\">üì¢</text>\n        <text class=\"setting-label\">ÂèçÈ¶à‰∏éÊîØÊåÅ</text>\n      </view>\n      <text class=\"arrow\">></text>\n    </view>\n\n    <!-- ÈÄÄÂá∫ÁôªÂΩïÊåâÈíÆ -->\n    <view class=\"settings-card setting-item\" @tap=\"onLogout\">\n      <view class=\"setting-left\">\n        <text class=\"setting-icon\">üö™</text>\n        <text class=\"setting-label logout\">ÈÄÄÂá∫ÁôªÂΩï</text>\n      </view>\n      <text class=\"arrow\">></text>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { apiService } from '@/utils/api.js'  // Ê∑ªÂä†ÂØºÂÖ•\n\nexport default {\n  data() {\n    return {\n      userInfo: {\n        user_id: '',\n        nickname: '',\n        avatar_url: '',\n        ai_character_name: '',\n        telephone: '',\n      },\n      aiCharacters: [], // AIËßíËâ≤ÂàóË°®\n      selectedRoleIndex: 0\n    }\n  },\n\n  computed: {\n    aiCharacterNames() {\n      return this.aiCharacters.map(char => char.name)\n    },\n    currentCharacterName() {\n      if (this.aiCharacters.length === 0) return 'Âä†ËΩΩ‰∏≠...'\n      return this.aiCharacters[this.selectedRoleIndex]?.name || 'ËØ∑ÈÄâÊã©ËßíËâ≤'\n    }\n  },\n\n  onLoad() {\n    this.loadUserInfo()\n    this.loadAICharacters()\n  },\n\n  methods: {\n    loadUserInfo() {\n      const userInfo = uni.getStorageSync('userInfo')\n      if (userInfo) {\n        this.userInfo = userInfo\n      }\n    },\n\n    async loadAICharacters() {\n      try {\n        // ÂÖà‰ªéÊú¨Âú∞Ëé∑ÂèñËßíËâ≤ÂàóË°®\n        const characters = uni.getStorageSync('aiCharacters')\n        if (characters) {\n          this.aiCharacters = characters\n          \n          // Â¶ÇÊûúÁî®Êà∑ÊúâËÆæÁΩÆËßíËâ≤ÔºåÊâæÂà∞ÂØπÂ∫îÁöÑÁ¥¢Âºï\n          if (this.userInfo.ai_character_name) {\n            const currentIndex = this.aiCharacters.findIndex(\n              char => char.name === this.userInfo.ai_character_name\n            )\n            if (currentIndex !== -1) {\n              this.selectedRoleIndex = currentIndex\n            }\n          }\n        } else {\n          // Â¶ÇÊûúÊú¨Âú∞Ê≤°ÊúâËßíËâ≤ÂàóË°®Ôºå‰ªéÊúçÂä°Âô®Ëé∑Âèñ\n          const response = await apiService.getAICharacterList()\n          if (response.status === 'success') {\n            this.aiCharacters = response.data\n            uni.setStorageSync('aiCharacters', response.data)\n            \n            // ËÆæÁΩÆÂΩìÂâçÈÄâ‰∏≠ÁöÑËßíËâ≤Á¥¢Âºï\n            if (this.userInfo.ai_character_name) {\n              const currentIndex = this.aiCharacters.findIndex(\n                char => char.name === this.userInfo.ai_character_name\n              )\n              if (currentIndex !== -1) {\n                this.selectedRoleIndex = currentIndex\n              }\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Âä†ËΩΩAIËßíËâ≤Â§±Ë¥•:', error)\n        uni.showToast({\n          title: 'Âä†ËΩΩËßíËâ≤Â§±Ë¥•',\n          icon: 'none'\n        })\n      } finally {\n        uni.hideLoading()\n      }\n    },\n\n    onPrivacy() {\n      uni.showToast({\n        title: 'ÂäüËÉΩÂºÄÂèë‰∏≠',\n        icon: 'none'\n      })\n    },\n\n    onFeedback() {\n      uni.showModal({\n        title: 'ÊÑèËßÅÂèçÈ¶à',\n        content: 'ËØ∑ÈÄöËøá‰ª•‰∏ãÈÇÆÁÆ±ËÅîÁ≥ªÊàë‰ª¨Ôºö\\nsupport@habitai.com',\n        showCancel: false\n      })\n    },\n\n    onLogout() {\n      uni.showModal({\n        title: 'Á°ÆËÆ§ÈÄÄÂá∫',\n        content: 'Á°ÆÂÆöË¶ÅÈÄÄÂá∫ÁôªÂΩïÂêóÔºü',\n        success: (res) => {\n          if (res.confirm) {\n            uni.clearStorageSync()\n            uni.reLaunch({\n              url: '/pages/login/login'\n            })\n          }\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style>\n.container {\n  padding: 30rpx;\n  background: #f5f7fa;\n  min-height: 100vh;\n}\n\n.settings-section {\n  background: #f5f7fa;\n}\n\n.settings-card {\n  background: #fff;\n  border-radius: 20rpx;\n  padding: 30rpx;\n  margin-bottom: 20rpx;\n}\n\n.user-info-section {\n  background: var(--theme-color);\n  display: flex;\n  align-items: center;\n  padding: 40rpx;\n  height: 200rpx;\n  border-radius: 20rpx;\n  margin-bottom: 20rpx;\n}\n\n.avatar-wrapper {\n  width: 120rpx;\n  height: 120rpx;\n  border-radius: 50%;\n  overflow: hidden;\n  border: 4rpx solid rgba(255, 255, 255, 0.3);\n}\n\n.avatar {\n  width: 100%;\n  height: 100%;\n}\n\n.user-info {\n  margin-left: 30rpx;\n  color: #fff;\n}\n\n.nickname {\n  font-size: 36rpx;\n  font-weight: 600;\n  margin-bottom: 10rpx;\n}\n\n.setting-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  min-height: 100rpx;\n  cursor: pointer; /* Ê∑ªÂä†ÊâãÂûãÂÖâÊ†á */\n}\n\n.setting-item:active {\n  opacity: 0.8; /* Ê∑ªÂä†ÁÇπÂáªÂèçÈ¶àÊïàÊûú */\n}\n\n.setting-left {\n  display: flex;\n  align-items: center;\n  gap: 20rpx;\n}\n\n.setting-icon {\n  font-size: 40rpx;\n}\n\n.setting-info {\n  display: flex;\n  flex-direction: column;\n  gap: 6rpx;\n}\n\n.setting-label {\n  font-size: 30rpx;\n  color: #2c3e50;\n}\n\n.setting-desc {\n  font-size: 24rpx;\n  color: #5c6b7a;\n}\n\n.arrow {\n  color: #5c6b7a;\n  font-size: 30rpx;\n}\n\n.picker-value {\n  color: #5c6b7a;\n  font-size: 30rpx;\n  display: flex;\n  align-items: center;\n  gap: 10rpx;\n}\n\n.logout .setting-label {\n  color: #ff3b30;\n}\n</style>\n","import MiniProgramPage from '/Users/linsir/Experiments/uni-app/habit-ai-uniapp/habit-ai-uniapp/pages/settings/settings.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","apiService"],"mappings":";;;AAgEA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,UAAU;AAAA,QACR,SAAS;AAAA,QACT,UAAU;AAAA,QACV,YAAY;AAAA,QACZ,mBAAmB;AAAA,QACnB,WAAW;AAAA,MACZ;AAAA,MACD,cAAc,CAAE;AAAA;AAAA,MAChB,mBAAmB;AAAA,IACrB;AAAA,EACD;AAAA,EAED,UAAU;AAAA,IACR,mBAAmB;AACjB,aAAO,KAAK,aAAa,IAAI,UAAQ,KAAK,IAAI;AAAA,IAC/C;AAAA,IACD,uBAAuB;;AACrB,UAAI,KAAK,aAAa,WAAW;AAAG,eAAO;AAC3C,eAAO,UAAK,aAAa,KAAK,iBAAiB,MAAxC,mBAA2C,SAAQ;AAAA,IAC5D;AAAA,EACD;AAAA,EAED,SAAS;AACP,SAAK,aAAa;AAClB,SAAK,iBAAiB;AAAA,EACvB;AAAA,EAED,SAAS;AAAA,IACP,eAAe;AACb,YAAM,WAAWA,cAAAA,MAAI,eAAe,UAAU;AAC9C,UAAI,UAAU;AACZ,aAAK,WAAW;AAAA,MAClB;AAAA,IACD;AAAA,IAED,MAAM,mBAAmB;AACvB,UAAI;AAEF,cAAM,aAAaA,cAAAA,MAAI,eAAe,cAAc;AACpD,YAAI,YAAY;AACd,eAAK,eAAe;AAGpB,cAAI,KAAK,SAAS,mBAAmB;AACnC,kBAAM,eAAe,KAAK,aAAa;AAAA,cACrC,UAAQ,KAAK,SAAS,KAAK,SAAS;AAAA,YACtC;AACA,gBAAI,iBAAiB,IAAI;AACvB,mBAAK,oBAAoB;AAAA,YAC3B;AAAA,UACF;AAAA,eACK;AAEL,gBAAM,WAAW,MAAMC,UAAU,WAAC,mBAAmB;AACrD,cAAI,SAAS,WAAW,WAAW;AACjC,iBAAK,eAAe,SAAS;AAC7BD,0BAAAA,MAAI,eAAe,gBAAgB,SAAS,IAAI;AAGhD,gBAAI,KAAK,SAAS,mBAAmB;AACnC,oBAAM,eAAe,KAAK,aAAa;AAAA,gBACrC,UAAQ,KAAK,SAAS,KAAK,SAAS;AAAA,cACtC;AACA,kBAAI,iBAAiB,IAAI;AACvB,qBAAK,oBAAoB;AAAA,cAC3B;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACA,SAAO,OAAO;AACdA,sBAAAA,MAAc,MAAA,SAAA,sCAAA,aAAa,KAAK;AAChCA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,SACP;AAAA,MACH,UAAU;AACRA,sBAAAA,MAAI,YAAY;AAAA,MAClB;AAAA,IACD;AAAA,IAED,YAAY;AACVA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,MAAM;AAAA,OACP;AAAA,IACF;AAAA,IAED,aAAa;AACXA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,YAAY;AAAA,OACb;AAAA,IACF;AAAA,IAED,WAAW;AACTA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,SAAS;AACfA,0BAAAA,MAAI,iBAAiB;AACrBA,0BAAAA,MAAI,SAAS;AAAA,cACX,KAAK;AAAA,aACN;AAAA,UACH;AAAA,QACF;AAAA,OACD;AAAA,IACH;AAAA,EACF;AACF;;;;;;;;;;;;;;;AChLA,GAAG,WAAW,eAAe;"}