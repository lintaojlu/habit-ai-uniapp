{"version":3,"file":"login.js","sources":["pages/login/login.vue","pages/login/login.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"logo-section\">\n      <image class=\"poster\" src=\"/static/poster.png\" mode=\"aspectFit\" />\n      <text class=\"app-name\">HabitAI</text>\n      <text class=\"slogan\">Take easy steps to achieve your goals!</text>\n    </view>\n\n    <view class=\"form-section\">\n      <input \n        class=\"input-field\" \n        type=\"text\" \n        v-model=\"telephone\" \n        placeholder=\"ÊâãÊú∫Âè∑\"\n      />\n      <input \n        class=\"input-field\" \n        type=\"password\" \n        v-model=\"password\" \n        placeholder=\"ÂØÜÁ†Å\"\n      />\n      <button class=\"submit-button\" @tap=\"handleSubmit\">ÁôªÂΩï</button>\n      <text class=\"switch-mode\" @tap=\"goToRegister\">\n        Êñ∞Êù•ÁöÑÔºüÁÇπÊàëÁÇπÊàëüòé\n      </text>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { apiService } from '@/utils/api.js'\n\nexport default {\n  data() {\n    return {\n      telephone: '',\n      password: ''\n    }\n  },\n  methods: {\n    goToRegister() {\n      uni.navigateTo({\n        url: '/pages/register/register'\n      })\n    },\n    async handleSubmit() {\n      if (!this.telephone || !this.password) {\n        uni.showToast({\n          title: 'ËØ∑Â°´ÂÜôÂÆåÊï¥‰ø°ÊÅØ',\n          icon: 'none'\n        })\n        return\n      }\n      \n      uni.showLoading({\n        title: 'ÁôªÂΩï‰∏≠...'\n      })\n      \n      try {\n        const res = await apiService.login({\n          telephone: this.telephone,\n          password: this.password\n        })\n        \n        if (res.status === 'success') {\n          // Ê∏ÖÁ©∫Êú¨Âú∞Â≠òÂÇ®\n          uni.clearStorageSync();\n\n\n          // ‰øùÂ≠ò token ÂíåÁî®Êà∑‰ø°ÊÅØ\n          uni.setStorageSync('token', res.token)\n          \n          // Ëé∑ÂèñÁî®Êà∑ËØ¶ÁªÜ‰ø°ÊÅØ\n          const userInfo = await apiService.getUserInfo()\n          if (userInfo.status === 'success') {\n            uni.setStorageSync('userInfo', userInfo.data)\n            console.log(\"get userInfo from server\", userInfo.data)\n          }\n\n          // Ëé∑Âèñ‰π†ÊÉØÂàóË°®\n          const habitList = await apiService.getHabitList()\n          if (habitList.status === 'success') {\n              // Â§ÑÁêÜ habitList.dataÔºåÁ°Æ‰øùÊØè‰∏™‰π†ÊÉØÈÉΩÊúâ icon Âíå color\n              this.habits = habitList.data.map(habit => ({\n                  ...habit,\n                  icon: habit.icon || \"‚ú®\",\n                  color: habit.color || '$theme-color'\n              }))\n              // Êõ¥Êñ∞Êú¨Âú∞Â≠òÂÇ®ÂíåÊï∞ÊçÆ\n              uni.setStorageSync('habits', habitList.data)\n              console.log(\"get habits from server\", habitList.data)\n          }\n\n          // Ëé∑ÂèñAIËßíËâ≤ÂàóË°®\n          const response = await apiService.getAICharacterList()\n          if (response.status === 'success') {\n            uni.setStorageSync('aiCharacters', response.data)\n            console.log(\"get aiCharacters from server\", response.data)\n          }\n              \n          \n          uni.showToast({\n            title: 'ÁôªÂΩïÊàêÂäü',\n            icon: 'success'\n          })\n          \n          // Ë∑≥ËΩ¨Âà∞È¶ñÈ°µ\n          uni.reLaunch({\n            url: '/pages/index/index'\n          })\n        } else {\n          throw new Error(res.message || 'ÁôªÂΩïÂ§±Ë¥•')\n        }\n      } catch (error) {\n        uni.showToast({\n          title: error.message || 'ÁôªÂΩïÂ§±Ë¥•',\n          icon: 'none'\n        })\n      } finally {\n        uni.hideLoading()\n      }\n    }\n  }\n}\n</script>\n\n<style>\n.container {\n  padding: 40rpx;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-height: 100vh;\n  background-color: #fff;\n}\n\n.logo-section {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-bottom: 80rpx;\n}\n\n.poster {\n  width: 400rpx;\n  height: 400rpx;\n  margin-bottom: 30rpx;\n  border-radius: 50%;\n}\n\n.app-name {\n  font-size: 48rpx;\n  font-weight: bold;\n  color: #2c3e50;\n  margin-bottom: 20rpx;\n}\n\n.slogan {\n  font-size: 32rpx;\n  color: #5c6b7a;\n}\n\n.form-section {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  gap: 30rpx;\n}\n\n.input-field {\n  width: 100%;\n  height: 100rpx;\n  background: #f5f7fa;\n  border-radius: 20rpx;\n  padding: 0 30rpx;\n  font-size: 32rpx;\n  color: #2c3e50;\n}\n\n.submit-button {\n  width: 100%;\n  height: 100rpx;\n  background: var(--theme-color);\n  border-radius: 20rpx;\n  color: #fff;\n  font-size: 32rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-top: 20rpx;\n}\n\n.submit-button:active {\n  opacity: 0.9;\n}\n\n.switch-mode {\n  text-align: center;\n  color: var(--theme-color);\n  font-size: 28rpx;\n  margin-top: 30rpx;\n}\n</style>","import MiniProgramPage from '/Users/linsir/Experiments/uni-app/habit-ai-uniapp/habit-ai-uniapp/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","apiService"],"mappings":";;;;AAgCA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,WAAW;AAAA,MACX,UAAU;AAAA,IACZ;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACP,eAAe;AACbA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,OACN;AAAA,IACF;AAAA,IACD,MAAM,eAAe;AACnB,UAAI,CAAC,KAAK,aAAa,CAAC,KAAK,UAAU;AACrCA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,SACP;AACD;AAAA,MACF;AAEAA,oBAAAA,MAAI,YAAY;AAAA,QACd,OAAO;AAAA,OACR;AAED,UAAI;AACF,cAAM,MAAM,MAAMC,UAAU,WAAC,MAAM;AAAA,UACjC,WAAW,KAAK;AAAA,UAChB,UAAU,KAAK;AAAA,SAChB;AAED,YAAI,IAAI,WAAW,WAAW;AAE5BD,wBAAG,MAAC,iBAAgB;AAIpBA,wBAAAA,MAAI,eAAe,SAAS,IAAI,KAAK;AAGrC,gBAAM,WAAW,MAAMC,UAAU,WAAC,YAAY;AAC9C,cAAI,SAAS,WAAW,WAAW;AACjCD,0BAAAA,MAAI,eAAe,YAAY,SAAS,IAAI;AAC5CA,0BAAA,MAAA,MAAA,OAAA,+BAAY,4BAA4B,SAAS,IAAI;AAAA,UACvD;AAGA,gBAAM,YAAY,MAAMC,UAAU,WAAC,aAAa;AAChD,cAAI,UAAU,WAAW,WAAW;AAEhC,iBAAK,SAAS,UAAU,KAAK,IAAI,YAAU;AAAA,cACvC,GAAG;AAAA,cACH,MAAM,MAAM,QAAQ;AAAA,cACpB,OAAO,MAAM,SAAS;AAAA,YAC1B,EAAE;AAEFD,0BAAAA,MAAI,eAAe,UAAU,UAAU,IAAI;AAC3CA,0BAAY,MAAA,MAAA,OAAA,+BAAA,0BAA0B,UAAU,IAAI;AAAA,UACxD;AAGA,gBAAM,WAAW,MAAMC,UAAU,WAAC,mBAAmB;AACrD,cAAI,SAAS,WAAW,WAAW;AACjCD,0BAAAA,MAAI,eAAe,gBAAgB,SAAS,IAAI;AAChDA,0BAAY,MAAA,MAAA,OAAA,+BAAA,gCAAgC,SAAS,IAAI;AAAA,UAC3D;AAGAA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,WACP;AAGDA,wBAAAA,MAAI,SAAS;AAAA,YACX,KAAK;AAAA,WACN;AAAA,eACI;AACL,gBAAM,IAAI,MAAM,IAAI,WAAW,MAAM;AAAA,QACvC;AAAA,MACA,SAAO,OAAO;AACdA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO,MAAM,WAAW;AAAA,UACxB,MAAM;AAAA,SACP;AAAA,MACH,UAAU;AACRA,sBAAAA,MAAI,YAAY;AAAA,MAClB;AAAA,IACF;AAAA,EACF;AACF;;;;;;;;;;;;;AC1HA,GAAG,WAAW,eAAe;"}